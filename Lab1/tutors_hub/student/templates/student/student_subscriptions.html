{% extends "student/student.html" %}
{% load custom_filters %}


{% block student_content %}
    <h1>Subscriptions</h1>

    <div>
        <table class="table">
            <thead>
            <tr>
                <th scope="col">Title</th>
                <th scope="col">Subscribed</th>
                <th scope="col">Lesson count</th>
                <th></th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            {% for subscription in subscriptions %}
                <tr class="{% if subscription.active %}table-success{% else %}table-secondary{% endif %}">
                    <td>{{ subscription.subject.title|truncate:20 }}</td>
                    <td>{{ subscription.subscribed }}</td>
                    <td>{{ subscription.lesson_count }}</td>
                    <th><a href="/subject/{{ subscription.subject.id }}">View</a></th>
                    <th>
                        {% if subscription.active %}
                        <form id="unsubscribe-form-{{ subject.id }}" method="POST" action="/subject/{{ subscription.id }}/unsubscribe">
                            {% csrf_token %}
                        </form>
                        <button class="btn-link" type="button"
                                onclick="openModal('Do you really want to unsubscribe from {{ subscription.subject.title|truncate:20 }}?',
                                        'unsubscribe-form-{{ subject.id }}')">
                            Unsubscribe
                        </button>
                        {% else %}
                        <div class="text-dark">Unsubscribed</div>
                        {% endif %}
                    </th>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}